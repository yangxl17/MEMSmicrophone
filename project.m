clear all;clc
f=100:1:55500;
w=2*pi*f;
L=2.2*1e-3;
a=15*1e-6;
b=80*1e-6;
K=1-0.14;
Vbias=15;
p0=1.29;
c=340;
od=30*1e6;
ob=20*1e6;
hd=1.1*1e-6;
hb=15*1e-6;
pd=1011;
pb=1011;
ha=3.6*1e-6;
n=1.85*1e-5;
Rrw=(0.1886/pi^3)*(L^6)*p0.*w/(c^3);
Mr=2.67*(L^3)*p0/pi^(3/2);
Cd=1/(30*od*hd);
Cb=1/(30*hb*ob*sqrt(1-4*a^2/b^2));
Md=pd*hd*L^2;
Mb=pb*hb*sqrt(1-4*a^2/b^2)*L^2;
B=1/4*log(0.160*(b^2)/(a^2))-3/8+3.133*(a^2)/(b^2)-4.907*(a^4)/(b^4);
Ra=1.22*n*pi*(L^2)*(b^2)/(ha^3)*B;
Ma=0.102*p0*pi*(L^2)*(b^2)*B/ha;
Rh=12*n*hb*L^2/(b^2);
Mh=24*p0*hb*(a^2)*(L^2)/(b^2)/5;
s=1i*w;
V=L^2;
R1=Rrw+Mr.*s+1/Cd./s+Md.*s;
R2=Ra+Ma.*s+Rh+Mh.*s;
R3=1/Cb./s+Mb.*s;
xa=V.*R3./(R1.*R2+R2.*R3+R3.*R1)./w;
vout=xa*K*Vbias/ha;
figure
semilogx(f,20*log10(abs(vout)));
xlabel("f/Hz")
ylabel("sensitivity/dB")
grid on
